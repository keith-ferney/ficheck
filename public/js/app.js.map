{"version":3,"sources":["app.js","monthly-tracking.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["","(function($){\n  // store the monthlyTrackingContainer\n  var monthlyTrackingContainer = $('.monthly-tracking')\n\n  // handler for the add tracking record control\n  monthlyTrackingContainer.on('click', 'button.add', function(e){\n    var currentRecord = $(this).closest('form');\n    var newRecord = currentRecord.clone();\n\n    $(':input', newRecord).val('').removeAttr('disabled').closest('form').removeClass('changed');\n\n    currentRecord.after(newRecord);\n\n    newRecord.find('input:visible').first().trigger('focus');\n\n    return false;\n  });\n\n  // disable in/out if other if filled in  (only one or the other should be active)\n  monthlyTrackingContainer.on('change', '[name=in],[name=out]', function(){\n    var form = $(this).closest('form');\n\n    var sibling = form.find('[name=in],[name=out]').not(this);\n\n    if($(this).val()) {\n      sibling.attr('disabled', true);\n    } else {\n      sibling.removeAttr('disabled');\n    }\n  }).find('[name=in],[name=out]').trigger('change');\n\n  // if an input changes and the form is valid, submit it via ajax\n  monthlyTrackingContainer.on('change', 'input', function(){\n    var form = $(this).closest('form');\n\n    var changed = false;\n    $('input', form).each(function(){\n        changed = this.value != this.defaultValue;\n\n        return !changed; // return if at least one control has changed value\n    });\n\n    if(changed) {\n      form.addClass('changed');\n    }\n\n    if(form.hasClass('changed') && form.find('[name=date]').val() && (form.find('[name=in]').val() || form.find('[name=out]').val())) {\n      var form = $(this).closest('form');\n      var data = form.serialize();\n\n      $.ajax({\n        url: form.action,\n        data: data,\n        method: \"post\",\n        success: function() {\n          form.removeClass('changed');\n\n          if(form.hasClass('new')) {\n            form.removeClass('new');\n          }\n        }\n      });\n    }\n  });\n\n  // track the active form (show controls via css)\n  monthlyTrackingContainer.on('focus', 'form input', function() {\n    monthlyTrackingContainer.find('form').removeClass('active');\n\n    $(this).closest('form').addClass('active');\n  });\n}(jQuery));\n"],"sourceRoot":"/source/"}